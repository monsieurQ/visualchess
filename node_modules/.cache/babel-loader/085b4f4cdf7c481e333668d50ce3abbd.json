{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/q/Documents/WebDocuments/ChessReact/chess/src/App.js\";\nimport './App.css';\nimport React, { Component } from 'react'; // import Board from './components/Board/Board';\n\nimport Moves from './components/Moves/Moves';\nimport Square from './components/Square/Square';\nimport Squares from './components/Squares/Squares'; // TYPES (negative values for black)\n// PAWN - 1 \n// BISHOP - 2 \n// KNIGHT - 3 \n// ROOK - 4\n// QUEEN - 5 \n// KING - 6 \n\nconst startingPosition = [-4, -2, -3, -5, -6, -3, -2, -4, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 4, 2, 3, 5, 6, 3, 2, 4];\n\nclass App extends Component {\n  constructor() {\n    super();\n\n    this.createSquares = position => {\n      let squares = []; // let piece_clicked = this.state.piece_clicked;\n\n      let click = this.handleClick;\n      let pClick = this.handlePieceClick;\n      let onDrop = this.dropHandler;\n      position.forEach((square, index) => {\n        squares[index] = /*#__PURE__*/_jsxDEV(Square, {\n          pClick: pClick,\n          index: index,\n          onClick: click,\n          onDrop: onDrop // classes={bgs[tick]} \n          ,\n          piece: square\n        }, 's' + index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 51,\n          columnNumber: 24\n        }, this);\n      });\n      return squares;\n    };\n\n    this.moveClick = number => {\n      console.log('move clicked', number);\n      this.setState(prevState => ({\n        selectedMove: number\n      }));\n    };\n\n    this.handleClick = e => {\n      console.log(`handleClick, ${e} clicked`);\n      let clicked = this.state.piece_clicked;\n\n      if (clicked !== null) {\n        this.setState({\n          piece_clicked: null\n        }, this.newMove(clicked, e));\n      }\n    };\n\n    this.handlePieceClick = e => {\n      let clicked = this.state.piece_clicked;\n      if (clicked === null) this.setState({\n        piece_clicked: e\n      });else {\n        this.setState({\n          piece_clicked: false\n        }, this.newMove(clicked, e));\n      }\n    };\n\n    this.dropHandler = e => {\n      e.preventDefault();\n      e.target.classList.remove('dragover');\n      let target = e.target.dataset.position;\n      let origin = e.dataTransfer.getData(\"text/plain\");\n      this.newMove(origin, target);\n    };\n\n    this.state = {\n      currentMove: 0,\n      lastMove: null,\n      colorToMove: 1,\n      piece_clicked: false,\n      selectedMove: 0,\n      positions: [startingPosition],\n      // 64-Array \n      squares: [this.createSquares(startingPosition)] // Positionen mit JSX schon drinnen \n\n    };\n  }\n\n  switchColor() {\n    return this.state.colorToMove === 1 ? -1 : 1;\n  }\n\n  getColor(square) {\n    return square < 0 ? -1 : 1;\n  }\n\n  hasPiece(square) {\n    return Math.abs(square) > 0;\n  }\n\n  newMove(from, to) {\n    let positions = JSON.parse(JSON.stringify(this.state.positions));\n    let old_position = Array.from(positions[positions.length - 1]);\n    let new_position = Array.from(old_position);\n    if (this.getColor(old_position[from]) !== this.state.colorToMove) return;\n\n    if (this.hasPiece(old_position[to])) {\n      if (this.getColor(old_position[from]) === this.getColor(old_position[to])) return;\n    }\n\n    let moved_piece = old_position[from];\n    new_position[to] = new_position[from];\n    new_position[from] = 0;\n    let new_squares = this.createSquares(new_position);\n    console.log(new_squares);\n    positions.push(new_position);\n    this.setState(prevState => ({\n      positions: positions,\n      lastMove: [prevState.currentMove, moved_piece, to],\n      currentMove: prevState.currentMove + 1,\n      selectedMove: prevState.selectedMove + 1,\n      colorToMove: this.switchColor(),\n      squares: prevState.squares.concat([new_squares])\n    }));\n  }\n\n  render() {\n    // let squares = (this.state.squares.hasOwnProperty(this.state.selectedMove))\n    //   ? this.state.squares[this.state.selectedMove]\n    //   : this.createSquares(this.state.positions[this.state.selectedMove]);\n    let position = this.state.positions[this.state.positions.length - 1];\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(Squares, {\n        position: position,\n        onClick: this.handleClick,\n        pClick: this.handlePieceClick,\n        onDrop: this.dropHandler\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"moves\",\n        children: [\" \", /*#__PURE__*/_jsxDEV(Moves, {\n          onClick: this.moveClick,\n          lastMove: this.state.lastMove\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 34\n        }, this), \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/q/Documents/WebDocuments/ChessReact/chess/src/App.js"],"names":["React","Component","Moves","Square","Squares","startingPosition","App","constructor","createSquares","position","squares","click","handleClick","pClick","handlePieceClick","onDrop","dropHandler","forEach","square","index","moveClick","number","console","log","setState","prevState","selectedMove","e","clicked","state","piece_clicked","newMove","preventDefault","target","classList","remove","dataset","origin","dataTransfer","getData","currentMove","lastMove","colorToMove","positions","switchColor","getColor","hasPiece","Math","abs","from","to","JSON","parse","stringify","old_position","Array","length","new_position","moved_piece","new_squares","push","concat","render"],"mappings":"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","sourcesContent":["import './App.css';\nimport React, { Component } from 'react';\n// import Board from './components/Board/Board';\nimport Moves from './components/Moves/Moves';\nimport Square from './components/Square/Square';\nimport Squares from './components/Squares/Squares';\n\n\n// TYPES (negative values for black)\n// PAWN - 1 \n// BISHOP - 2 \n// KNIGHT - 3 \n// ROOK - 4\n// QUEEN - 5 \n// KING - 6 \n\nconst startingPosition = \n[\n-4, -2, -3, -5, -6, -3, -2, -4,\n-1, -1, -1, -1, -1, -1, -1, -1,\n0, 0, 0, 0, 0, 0, 0, 0,\n0, 0, 0, 0, 0, 0, 0, 0,\n0, 0, 0, 0, 0, 0, 0, 0,\n0, 0, 0, 0, 0, 0, 0, 0,\n1, 1, 1, 1, 1, 1, 1, 1,\n4, 2, 3, 5, 6, 3, 2, 4\n];\n\nclass App extends Component {\n  constructor(){\n    super();\n    this.state = {\n      currentMove: 0,\n      lastMove: null,\n      colorToMove: 1,\n      piece_clicked: false,\n      selectedMove: 0,\n      positions: [startingPosition], // 64-Array \n      squares: [this.createSquares(startingPosition)] // Positionen mit JSX schon drinnen \n    };  \n  }\n\n  createSquares = (position) => {\n    let squares = [];\n    // let piece_clicked = this.state.piece_clicked;\n    let click = this.handleClick;\n    let pClick = this.handlePieceClick; \n    let onDrop = this.dropHandler;\n\n    position.forEach((square, index) => {\n      squares[index] = <Square key={'s'+index} pClick={pClick} index={index} onClick={click} onDrop={onDrop} \n      // classes={bgs[tick]} \n      piece={square} />;\n    });\n    return squares; \n  }\n\n  moveClick = (number) => {\n    console.log('move clicked',number);\n    this.setState(prevState=>({\n      selectedMove: number\n    }));\n  }\n\n  handleClick = (e) => {\n    console.log(`handleClick, ${e} clicked`);\n    let clicked = this.state.piece_clicked; \n    if(clicked!==null){\n      this.setState({piece_clicked: null}, this.newMove(clicked, e));\n    }\n  }\n\n  handlePieceClick = (e) => {\n    let clicked = this.state.piece_clicked; \n    if(clicked===null) this.setState({piece_clicked: e})\n    else{\n      this.setState({piece_clicked: false}, this.newMove(clicked, e));\n    }\n  }\n\n  dropHandler = (e) => {\n    e.preventDefault();\n    e.target.classList.remove('dragover');\n    let target = e.target.dataset.position; \n    let origin = e.dataTransfer.getData(\"text/plain\");\n    this.newMove(origin, target)\n  };\n\n  switchColor(){ return this.state.colorToMove === 1 ? -1 : 1; }\n\n  getColor(square){ return square<0 ? -1 : 1; }\n\n  hasPiece(square){ return Math.abs(square)>0; }\n\n  newMove(from, to){\n    let positions = JSON.parse(JSON.stringify(this.state.positions));\n    let old_position = Array.from(positions[positions.length-1]);\n    let new_position = Array.from(old_position);\n\n    if(this.getColor(old_position[from])!==this.state.colorToMove) return; \n    if(this.hasPiece(old_position[to])){ \n      if(this.getColor(old_position[from])===this.getColor(old_position[to])) return; \n    }\n    let moved_piece = old_position[from];\n    new_position[to] = new_position[from];\n    new_position[from] = 0;\n\n    let new_squares = this.createSquares(new_position);\n    console.log(new_squares);\n    positions.push(new_position);\n\n    this.setState(prevState=>({\n      positions: positions,\n      lastMove: [prevState.currentMove, moved_piece, to],\n      currentMove: prevState.currentMove+1,\n      selectedMove: prevState.selectedMove+1,\n      colorToMove: this.switchColor(),\n      squares: prevState.squares.concat([new_squares])\n    }));\n  }\n\n\n  render(){\n    // let squares = (this.state.squares.hasOwnProperty(this.state.selectedMove))\n    //   ? this.state.squares[this.state.selectedMove]\n    //   : this.createSquares(this.state.positions[this.state.selectedMove]);\n    let position = this.state.positions[this.state.positions.length-1]; \n\n    return(\n      <div className='container'>\n        {/* <div className=\"board\"> {squares} </div> */}\n        <Squares position={position} onClick={this.handleClick} pClick={this.handlePieceClick} onDrop={this.dropHandler} /> \n        <div className='moves' > <Moves onClick={this.moveClick} lastMove={this.state.lastMove} /> </div>\n      </div> \n    );\n  } \n\n\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}